## Must check following
- docker subnet ip
- directory ownership (./volumes)

## Verification on DB
### 1.Check role details (exists? replication privilege?)
```
cd /root
docker compose exec -u postgres postgres psql -U alfresco -d postgres -c "
SELECT rolname,
       rolcanlogin,
       rolreplication,
       rolvaliduntil
FROM pg_roles
WHERE rolname='replicator';
"
```
### 2. Verify replication slot(s) exist (DC or DR)
```
cd /root
docker compose exec -u postgres postgres psql -U alfresco -d postgres -c "
SELECT slot_name,
       slot_type,
       active,
       restart_lsn,
       wal_status
FROM pg_replication_slots
ORDER BY slot_name;
"
```

### 3. WAL receiver status (Postgres 16)
```
cd /root
docker compose exec -u postgres postgres psql -U alfresco -d postgres -c "
SELECT status,
       sender_host,
       sender_port,
       receive_start_lsn,
       written_lsn,
       flushed_lsn,
       latest_end_lsn,
       latest_end_time
FROM pg_stat_wal_receiver;
"
```

**********************************************************************************************************************************
# Verification 
## Verfy is standby connected + lag?
```
cd /root
docker compose exec -u postgres postgres psql -U alfresco -d postgres -c "
SELECT
  client_addr,
  state,
  sync_state,
  pg_wal_lsn_diff(pg_current_wal_lsn(), replay_lsn) AS bytes_behind,
  now() - reply_time AS last_reply_age
FROM pg_stat_replication;"
```
## On STANDBY (DC): am I receiving WAL from primary?
```
cd /root
docker compose exec -u postgres postgres psql -U alfresco -d postgres -c "
SELECT
  pg_is_in_recovery() AS standby,
  status,
  sender_host,
  now() - last_msg_receipt_time AS last_msg_age
FROM pg_stat_wal_receiver;"
```
